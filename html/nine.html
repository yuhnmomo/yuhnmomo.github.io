<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹ä¹ä¹˜æ³•æŒ‘æˆ°</title>
    <!-- å¼•å…¥ Tailwind CSS æ–¹ä¾¿å¿«é€Ÿç¾åŒ–é é¢ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ä½¿ç”¨ä¸€å€‹å¯æ„›çš„å­—é«” */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            touch-action: manipulation; /* ç¦ç”¨é›™æ“Šç¸®æ”¾ï¼Œæå‡è¡Œå‹•è£ç½®é«”é©— */
        }
        /* ç•¶è¼¸å…¥æ¡†è¢«é¸ä¸­æ™‚çš„æ¨£å¼ */
        .input-focus-ring:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }
        /* ç¦ç”¨æŒ‰éˆ•çš„æ¨£å¼ */
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: scale(1);
        }
        /* æ•¸å­—éµç›¤æŒ‰éˆ•é»æ“Šæ•ˆæœ */
        .numpad-btn:active {
            transform: scale(0.95);
            filter: brightness(0.9);
        }
        /* é€²åº¦æ¢çš„éæ¸¡æ•ˆæœ */
        #question-timer-bar {
            transition: width 0.2s linear, background-color 0.5s ease;
        }
        /* è®“å”¯è®€çš„è¼¸å…¥æ¡†çœ‹èµ·ä¾†è·Ÿæ­£å¸¸çš„ä¸€æ¨£ */
        input[readonly] {
            background-color: white;
            cursor: default;
        }
    </style>
</head>
<body class="bg-blue-50 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-md mx-4 bg-white rounded-2xl shadow-lg p-4 sm:p-6 text-center">
        
        <!-- éŠæˆ²æ¨™é¡Œ -->
        <h1 class="text-2xl sm:text-4xl font-bold text-blue-600 mb-1">ä¹ä¹ä¹˜æ³•æŒ‘æˆ°</h1>
        <p class="text-gray-500 mb-4 text-sm sm:text-base">æŒ‘æˆ°ä½ çš„é€Ÿåº¦æ¥µé™ï¼</p>

        <!-- é ‚éƒ¨æ§åˆ¶èˆ‡çµ±è¨ˆåˆ— -->
        <div class="flex flex-wrap items-center justify-between gap-2 mb-4 p-2 bg-gray-100 rounded-lg">
            <!-- çµ±è¨ˆæ•¸æ“š -->
            <div class="flex items-center gap-x-2 text-xs sm:text-sm text-gray-700">
                <span>â­•:<strong id="correct-count" class="font-bold text-green-600 ml-1">0</strong></span>
                <span class="text-gray-300">|</span>
                <span>âŒ:<strong id="incorrect-count" class="font-bold text-red-600 ml-1">0</strong></span>
                <span class="text-gray-300">|</span>
                <span>ğŸ¯:<strong id="success-rate" class="font-bold ml-1">0%</strong></span>
                <span class="text-gray-300">|</span>
                <span>â±ï¸:<strong id="total-timer" class="font-bold ml-1">0</strong></span>
            </div>
            <!-- é–‹å§‹æŒ‰éˆ• -->
            <button id="new-game-button" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg text-base sm:text-lg transition duration-200 shadow-md">
                é–‹å§‹
            </button>
        </div>


        <!-- é¡Œç›®å€åŸŸ -->
        <div id="question-container" class="my-4">
            <p id="question" class="text-5xl sm:text-6xl font-bold text-gray-800 tracking-wider"></p>
        </div>

        <!-- æ¯é¡Œä½œç­”æ™‚é–“é€²åº¦æ¢ -->
        <div class="w-full bg-gray-200 rounded-full h-3 sm:h-4 mb-4">
            <div id="question-timer-bar" class="bg-green-500 h-3 sm:h-4 rounded-full" style="width: 100%;"></div>
        </div>

        <!-- è¼¸å…¥èˆ‡é€å‡ºå€åŸŸ -->
        <div class="flex flex-col sm:flex-row gap-2 items-center justify-center">
            <input type="number" id="answer-input" class="text-xl sm:text-2xl text-center w-full sm:w-40 px-3 py-2 border-2 border-gray-300 rounded-lg transition duration-200 input-focus-ring" placeholder="ç­”æ¡ˆ" autocomplete="off" readonly>
            <button id="submit-button" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white font-bold text-base sm:text-lg py-2.5 sm:py-3 px-6 sm:px-8 rounded-lg transition duration-200 transform hover:scale-105 shadow-md">
                é€å‡ºç­”æ¡ˆ
            </button>
        </div>

        <!-- å›é¥‹è¨Šæ¯ -->
        <div id="feedback" class="mt-4 h-6 text-base sm:text-xl font-semibold"></div>

        <!-- æ•¸å­—éµç›¤ -->
        <div id="numpad" class="grid grid-cols-3 gap-2 mt-3 max-w-xs mx-auto">
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">1</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">2</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">3</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">4</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">5</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">6</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">7</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">8</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">9</button>
            <button class="numpad-btn bg-yellow-400 hover:bg-yellow-500 text-white font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">â†</button>
            <button class="numpad-btn bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-2 sm:py-4 rounded-lg text-xl sm:text-2xl transition">0</button>
            <button class="numpad-btn bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 sm:py-4 rounded-lg text-2xl sm:text-3xl transition">â†µ</button>
        </div>

    </div>

    <script>
        // å–å¾—é é¢ä¸Šçš„å…ƒç´ 
        const questionEl = document.getElementById('question');
        const answerInput = document.getElementById('answer-input');
        const submitButton = document.getElementById('submit-button');
        const newGameButton = document.getElementById('new-game-button');
        const feedbackEl = document.getElementById('feedback');
        const totalTimerEl = document.getElementById('total-timer');
        const numpadEl = document.getElementById('numpad');
        const correctCountEl = document.getElementById('correct-count');
        const incorrectCountEl = document.getElementById('incorrect-count');
        const successRateEl = document.getElementById('success-rate');
        const questionTimerBar = document.getElementById('question-timer-bar');

        // éŠæˆ²ç‹€æ…‹è®Šæ•¸
        let correctCount = 0;
        let incorrectCount = 0;
        let num1, num2, correctAnswer;
        
        let totalTimerInterval; // ç¸½æ™‚é–“è¨ˆæ™‚å™¨
        let totalTimeElapsed = 0; // ç¸½æŒ‘æˆ°æ™‚é–“
        
        let questionTimerInterval; // æ¯é¡Œè¨ˆæ™‚å™¨
        const QUESTION_TIME_LIMIT = 30;
        let questionTimeLeft = QUESTION_TIME_LIMIT;

        let gameActive = false;


        // æ›´æ–°çµ±è¨ˆæ•¸æ“šé¡¯ç¤º
        function updateStats() {
            correctCountEl.textContent = correctCount;
            incorrectCountEl.textContent = incorrectCount;
            const totalAttempted = correctCount + incorrectCount;
            const rate = totalAttempted > 0 ? Math.round((correctCount / totalAttempted) * 100) : 0;
            successRateEl.textContent = `${rate}%`;
        }
        
        // åœæ­¢æ‰€æœ‰è¨ˆæ™‚å™¨
        function stopAllTimers() {
            clearInterval(totalTimerInterval);
            clearInterval(questionTimerInterval);
        }

        // è™•ç†æ™‚é–“åˆ°é‚„æ²’ç­”å°çš„æƒ…æ³
        function handleQuestionTimeout() {
            incorrectCount++;
            updateStats();
            feedbackEl.textContent = `æ™‚é–“åˆ°ï¼ç­”æ¡ˆæ˜¯ ${correctAnswer}`;
            feedbackEl.classList.remove('text-green-500', 'text-yellow-500');
            feedbackEl.classList.add('text-red-500');
            if (gameActive) {
                setTimeout(generateQuestion, 1500);
            }
        }

        // æ›´æ–°æ¯é¡Œè¨ˆæ™‚å™¨çš„é€²åº¦æ¢
        function updateQuestionTimerUI() {
            const percentage = (questionTimeLeft / QUESTION_TIME_LIMIT) * 100;
            questionTimerBar.style.width = `${percentage}%`;
            
            // æ ¹æ“šå‰©é¤˜æ™‚é–“æ”¹è®Šé¡è‰²
            questionTimerBar.classList.remove('bg-green-500', 'bg-yellow-500', 'bg-red-500');
            if (percentage < 25) {
                questionTimerBar.classList.add('bg-red-500');
            } else if (percentage < 50) {
                questionTimerBar.classList.add('bg-yellow-500');
            } else {
                questionTimerBar.classList.add('bg-green-500');
            }
        }

        // é–‹å§‹æ¯é¡Œçš„è¨ˆæ™‚å™¨
        function startQuestionTimer() {
            clearInterval(questionTimerInterval); // æ¸…é™¤èˆŠçš„
            questionTimeLeft = QUESTION_TIME_LIMIT;
            updateQuestionTimerUI();

            questionTimerInterval = setInterval(() => {
                questionTimeLeft--;
                updateQuestionTimerUI();
                if (questionTimeLeft <= 0) {
                    clearInterval(questionTimerInterval);
                    handleQuestionTimeout();
                }
            }, 1000);
        }
        
        // ç”¢ç”Ÿæ–°é¡Œç›®
        function generateQuestion() {
            num1 = Math.floor(Math.random() * 9) + 1;
            num2 = Math.floor(Math.random() * 9) + 1;
            correctAnswer = num1 * num2;
            questionEl.textContent = `${num1} Ã— ${num2} = ?`;
            answerInput.value = '';
            feedbackEl.textContent = '';
            answerInput.focus();
            startQuestionTimer();
        }

        // æª¢æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            if (!gameActive) return;

            const userAnswer = parseInt(answerInput.value, 10);
            if (isNaN(userAnswer)) {
                feedbackEl.textContent = 'è«‹è¼¸å…¥æ•¸å­—å–”ï¼';
                feedbackEl.classList.remove('text-green-500', 'text-red-500');
                feedbackEl.classList.add('text-yellow-500');
                return;
            }

            clearInterval(questionTimerInterval); // åœæ­¢æœ¬é¡Œè¨ˆæ™‚

            if (userAnswer === correctAnswer) {
                correctCount++;
                feedbackEl.textContent = 'ç­”å°äº†ï¼å¤ªæ£’äº†ï¼';
                feedbackEl.classList.remove('text-red-500', 'text-yellow-500');
                feedbackEl.classList.add('text-green-500');
            } else {
                incorrectCount++;
                feedbackEl.textContent = `ç­”éŒ¯äº†ï¼Œæ­£ç¢ºç­”æ¡ˆæ˜¯ ${correctAnswer}`;
                feedbackEl.classList.remove('text-green-500', 'text-yellow-500');
                feedbackEl.classList.add('text-red-500');
            }
            
            updateStats();
            setTimeout(generateQuestion, 1200);
        }

        // é–‹å§‹æ–°éŠæˆ²
        function startNewGame() {
            gameActive = true;
            newGameButton.textContent = 'é‡ä¾†';
            questionEl.classList.remove('text-3xl', 'sm:text-4xl');
            questionEl.classList.add('text-5xl', 'sm:text-6xl');
            correctCount = 0;
            incorrectCount = 0;
            totalTimeElapsed = 0;
            totalTimerEl.textContent = 0;
            updateStats();
            answerInput.disabled = false;
            submitButton.disabled = false;
            numpadEl.classList.remove('opacity-50', 'pointer-events-none');
            stopAllTimers();

            // å•Ÿå‹•ç¸½æ™‚é–“è¨ˆæ™‚å™¨ (æ¯ç§’æ›´æ–°)
            totalTimerInterval = setInterval(() => {
                totalTimeElapsed++;
                totalTimerEl.textContent = totalTimeElapsed;
            }, 1000);

            generateQuestion();
        }

        // å¹«æŒ‰éˆ•åŠ ä¸Šäº‹ä»¶ç›£è½
        submitButton.addEventListener('click', checkAnswer);
        newGameButton.addEventListener('click', startNewGame);

        // è®“ä½¿ç”¨è€…æŒ‰ä¸‹ Enter éµä¹Ÿèƒ½é€å‡ºç­”æ¡ˆ
        answerInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                checkAnswer();
            }
        });

        // æ•¸å­—éµç›¤çš„äº‹ä»¶ç›£è½
        numpadEl.addEventListener('click', (event) => {
            if (!gameActive || !event.target.matches('button')) return;

            const key = event.target.textContent;

            if (key === 'â†µ') {
                checkAnswer();
            } else if (key === 'â†') {
                answerInput.value = answerInput.value.slice(0, -1);
            } else {
                answerInput.value += key;
            }
            answerInput.focus();
        });

        // é é¢è¼‰å…¥æ™‚çš„åˆå§‹ç‹€æ…‹
        function initializeGame() {
            answerInput.disabled = true;
            submitButton.disabled = true;
            numpadEl.classList.add('opacity-50', 'pointer-events-none');
            newGameButton.textContent = 'é–‹å§‹';
            questionEl.textContent = 'æº–å‚™å¥½äº†å—ï¼Ÿ';
            questionEl.classList.remove('text-5xl', 'sm:text-6xl');
            questionEl.classList.add('text-3xl', 'sm:text-4xl');
            feedbackEl.textContent = 'é»æ“Šã€Œé–‹å§‹ã€æŒ‰éˆ•é€²è¡ŒéŠæˆ²ï¼';
            feedbackEl.classList.add('text-gray-500');
            updateStats();
            updateQuestionTimerUI();
        }

        initializeGame();

    </script>

</body>
</html>


